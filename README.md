# OpenSSL ファイル暗号化ツール

OpenSSLのAES-256暗号化を使用したPHPベースのファイル暗号化・復号化ユーティリティ

## 概要

このツールは、OpenSSLのAES-256アルゴリズムを使用して、安全なファイル暗号化および復号化機能を提供します。
元のファイル名と暗号化されたファイル名の対応関係を追跡するために、暗号化されたマッピングファイルを維持します。

## 機能

- **AES-256暗号化**: OpenSSLを利用したAES-256暗号化
- **ファイル名マッピング**: ファイル名もユニークID化。ファイル名対応表をAES-256で暗号
- **コマンドラインインターフェース**: 暗号化・復号化用のシンプルなPHPスクリプト

## 動作要件

- PHP 7.0以上
- OpenSSL拡張機能が有効
- OpenSSLコマンドラインツール

## 使用方法

### ファイルの暗号化

```bash
php encode.php <パスワード> <ファイルパス>
```

例：
```bash
php encode.php mypassword data/document.txt
```

## フォルダ内のzipファイル暗号化

```bash
php encode_zips.php <パスワード> <zipファイルフォルダパス> <出力フォルダパス>
```

例：
```bash
php encode_zips.php mypassword data/zips/ encrypted_zips/
```

このコマンドは指定されたフォルダ内のすべての`.zip`ファイルを暗号化し、指定された出力フォルダに保存します。

### ファイルの復号化

```bash
php decode.php <パスワード> <暗号化ファイルパス>
```

例：
```bash
php decode.php mypassword data/687c5c9f5bf78687c5c9f5bf7b
```

## 動作原理

1. **暗号化プロセス**:
   - 暗号化ファイル用の一意なランダムファイル名を生成
   - 元のファイル名と暗号化ファイル名の対応関係を`openssl_crypto.enc`に保存
   - 提供されたパスワードを使用してAES-256でターゲットファイルを暗号化
   - マッピングファイル自体も暗号化される

2. **復号化プロセス**:
   - マッピングファイルを復号化して元のファイル名を特定
   - 指定された暗号化ファイルを元の名前に復号化
   - 元のファイル名でファイルを復元

## ファイル構成

- `OpenSslCrypto.php` - メインの暗号化・復号化クラス
- `encode.php` - ファイル暗号化用コマンドラインスクリプト
- `decode.php` - ファイル復号化用コマンドラインスクリプト
- `openssl_crypto.enc` - 暗号化されたマッピングファイル（自動生成）

## セキュリティ上の注意事項

- 暗号化には強力なパスワードを使用してください
- パスワードを安全に保管し、平文で保存しないでください
- 暗号化ファイルをバックアップし、パスワードを忘れないようにしてください
- このツールは防御的セキュリティとデータ保護目的での使用を想定しています

MIT LICENSE
